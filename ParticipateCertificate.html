<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>OpenPlayground Certificate Generator</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{
  box-sizing:border-box;
  font-family:system-ui,-apple-system,BlinkMacSystemFont,sans-serif;
}

body{
  margin:0;
  min-height:100vh;
  background:linear-gradient(135deg,#020617,#0f172a);
  display:flex;
  align-items:center;
  justify-content:center;
  color:#e5e7eb;
}

.container{
  background:#020617;
  padding:30px 34px;
  border-radius:18px;
  width:100%;
  max-width:900px;
  box-shadow:0 30px 70px rgba(0,0,0,.65);
  text-align:center;
}

h1{ margin:0; font-size:1.8rem; }
.subtitle{ color:#94a3b8; font-size:.9rem; margin:6px 0 20px; }

input{
  width:100%;
  padding:12px 14px;
  border-radius:10px;
  border:none;
  margin-bottom:14px;
  font-size:.95rem;
}

button{
  width:100%;
  padding:12px;
  border:none;
  border-radius:10px;
  background:#22c55e;
  font-weight:600;
  cursor:pointer;
}

button:hover{ background:#16a34a; }

/* ================= CERTIFICATE ================= */

.wrapper{
  display:none;
  margin-top:30px;
  padding:6px;
  border-radius:22px;
  background:linear-gradient(135deg,#3b82f6,#8b5cf6,#ec4899);
}

/* FIXED SIZE (IMPORTANT) */
.certificate{
  width:800px;
  height:1120px;        /* A4 portrait */
  background:#ffffff;
  border-radius:18px;
  padding:50px;
  position:relative;
  overflow:hidden;
  color:#020617;
}

/* WATERMARK (REAL ELEMENT) */
.watermark{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:4rem;
  font-weight:800;
  color:#e5e7eb;
  opacity:.22;
  transform:rotate(-25deg);
  pointer-events:none;
}

.cert-inner{
  position:relative;
  z-index:2;
  text-align:center;
}

.cert-title{
  font-size:2.6rem;
  font-weight:800;
}

.cert-sub{
  margin-top:6px;
  font-size:1rem;
  color:#475569;
}

/* Badge */
.badge{
  margin:22px auto;
  width:100px;
  height:100px;
  border-radius:50%;
  background:linear-gradient(135deg,#3b82f6,#8b5cf6);
  display:flex;
  align-items:center;
  justify-content:center;
  color:white;
  font-size:2.2rem;
}

/* Avatar */
.avatar{
  width:110px;
  height:110px;
  border-radius:50%;
  border:4px solid #c7d2fe;
  margin:14px auto;
  display:block;
}

.cert-name{
  font-size:1.9rem;
  font-weight:700;
}

.cert-username{
  font-size:.95rem;
  color:#475569;
}

.cert-text{
  margin:22px auto;
  font-size:1rem;
  max-width:500px;
  line-height:1.6;
}

.cert-footer{
  margin-top:40px;
  display:flex;
  justify-content:space-between;
  font-size:.9rem;
  color:#475569;
}

.seal{
  width:70px;
  height:70px;
  border-radius:50%;
  border:3px dashed #8b5cf6;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:700;
  color:#8b5cf6;
}

/* Download buttons */
.download-btns{
  margin-top:16px;
  display:none;
  gap:12px;
}

.download-png{ background:#3b82f6; color:white; }
.download-pdf{ background:#8b5cf6; color:white; }
</style>
</head>

<body>

<main class="container">
  <h1>ðŸŽ“ Contribution Certificate</h1>
  <p class="subtitle">OpenPlayground Â· ECWOC 2026</p>

  <input id="username" placeholder="Enter GitHub username">
  <button onclick="generate()">Generate Certificate</button>

  <div class="wrapper" id="wrapper">
    <div class="certificate" id="certificate">

      <div class="watermark">OpenPlayground</div>

      <div class="cert-inner">
        <div class="cert-title">Certificate of Contribution</div>
        <div class="cert-sub">This is proudly presented to</div>

        <div class="badge">â˜…</div>

        <img id="avatar" class="avatar">

        <div class="cert-name" id="name"></div>
        <div class="cert-username" id="uname"></div>

        <div class="cert-text" id="details"></div>

        <div class="cert-footer">
          <div>
            Date: <span id="date"></span><br>
            <strong>OpenPlayground Team</strong>
          </div>
          <div class="seal">ECWOC</div>
        </div>
      </div>

    </div>
  </div>

  <div class="download-btns" id="downloadBtns">
    <button class="download-png" onclick="downloadPNG()">Download PNG</button>
    <button class="download-pdf" onclick="downloadPDF()">Download PDF</button>
  </div>
</main>

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>
async function generate(){
  const user=document.getElementById("username").value.trim();
  if(!user) return alert("Enter GitHub username");

  const res=await fetch(`https://api.github.com/users/${user}`);
  if(!res.ok) return alert("User not found");

  const data=await res.json();

  wrapper.style.display="block";
  downloadBtns.style.display="flex";

  name.textContent=data.name || data.login;
  uname.textContent=`GitHub: @${data.login}`;
  date.textContent=new Date().toDateString();

  details.innerHTML=
    `has successfully contributed to the <strong>OpenPlayground</strong> open-source project
     during <strong>ECWOC 2026</strong>, demonstrating collaboration and consistency.`;

  loadAvatar(data.avatar_url);
}

/* SAFE AVATAR (CORS FIX) */
function loadAvatar(url){
  const img=new Image();
  img.crossOrigin="anonymous";
  img.src=url;

  img.onload=()=>{
    const canvas=document.createElement("canvas");
    canvas.width=110;
    canvas.height=110;
    const ctx=canvas.getContext("2d");

    ctx.beginPath();
    ctx.arc(55,55,55,0,Math.PI*2);
    ctx.closePath();
    ctx.clip();

    ctx.drawImage(img,0,0,110,110);
    avatar.src=canvas.toDataURL("image/png");
  };
}

/* PERFECT PNG DOWNLOAD */
function downloadPNG(){
  html2canvas(certificate,{
    scale:3,
    useCORS:true,
    backgroundColor:"#ffffff"
  }).then(canvas=>{
    const link=document.createElement("a");
    link.download="OpenPlayground_Certificate.png";
    link.href=canvas.toDataURL("image/png",1);
    link.click();
  });
}

/* PERFECT PDF DOWNLOAD */
function downloadPDF(){
  html2canvas(certificate,{scale:3,useCORS:true}).then(canvas=>{
    const img=canvas.toDataURL("image/png");
    const { jsPDF }=window.jspdf;

    const pdf=new jsPDF("portrait","px",[800,1120]);
    pdf.addImage(img,"PNG",0,0,800,1120);
    pdf.save("OpenPlayground_Certificate.pdf");
  });
}
</script>

</body>
</html>
