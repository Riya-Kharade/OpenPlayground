<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‚öõÔ∏è QUANTUM STACK ¬∑ layer your thoughts</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: linear-gradient(145deg, #180e28, #1a1b2f);
      font-family: 'Inter', 'Segoe UI', system-ui, sans-serif;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .quantum-lab {
      max-width: 1400px;
      width: 100%;
      background: #252041d9;
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border-radius: 80px 80px 60px 60px;
      padding: 30px 30px 35px;
      border: 3px solid #a38fd6;
      box-shadow: 0 30px 50px -15px #040116, inset 0 0 30px #7b64c4;
    }

    /* header with quantum state */
    .quantum-header {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      background: #332b55cc;
      border-radius: 100px;
      padding: 12px 30px 12px 40px;
      margin-bottom: 30px;
      border: 2px solid #bfaaff;
    }

    .title-stack {
      display: flex;
      align-items: center;
      gap: 18px;
    }

    .title-stack h1 {
      font-size: 3rem;
      font-weight: 500;
      background: linear-gradient(145deg, #d9c9ff, #b39aff);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      letter-spacing: 2px;
    }

    .stack-counter {
      background: #544394;
      border-radius: 60px;
      padding: 10px 35px;
      color: #ede4ff;
      font-weight: 600;
      font-size: 1.5rem;
      border: 2px solid #c7b1ff;
    }

    /* main area: stack and controls */
    .stack-arena {
      display: flex;
      flex-wrap: wrap;
      gap: 25px;
      margin-bottom: 30px;
    }

    /* the quantum stack (tower) */
    .stack-tower {
      flex: 2;
      min-width: 320px;
      background: #2e2550b3;
      border-radius: 70px;
      padding: 25px;
      border: 3px solid #b197fa;
      display: flex;
      flex-direction: column;
    }

    .tower-label {
      display: flex;
      align-items: center;
      gap: 12px;
      color: #dfd2ff;
      font-size: 1.8rem;
      margin-bottom: 20px;
      padding-left: 15px;
    }

    .stack-container {
      background: #1b1438;
      border-radius: 60px;
      padding: 25px 20px;
      min-height: 380px;
      border: 2px solid #9680d4;
      box-shadow: inset 0 0 40px #0f0a24;
      display: flex;
      flex-direction: column-reverse; /* newest on top visually but we'll manage */
      align-items: center;
      gap: 12px;
    }

    .quantum-layer {
      background: #4a3f79;
      border-radius: 50px;
      padding: 18px 30px;
      width: 90%;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border: 3px solid #c3adff;
      box-shadow: 0 6px 0 #2d2352;
      transition: 0.1s;
    }

    .layer-left {
      display: flex;
      align-items: center;
      gap: 18px;
    }

    .layer-emoji {
      font-size: 2.5rem;
    }

    .layer-text {
      font-size: 1.4rem;
      font-weight: 500;
      color: #f5eeff;
      max-width: 200px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .layer-stability {
      background: #1e193a;
      border-radius: 40px;
      padding: 8px 18px;
      color: #b3f0ff;
      font-weight: 600;
    }

    .remove-layer {
      background: #8f77c4;
      border: none;
      color: #1e1028;
      font-size: 1.8rem;
      width: 50px;
      height: 50px;
      border-radius: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 0 5px 0 #4d3980;
      transition: 0.05s;
    }

    .remove-layer:active {
      transform: translateY(5px);
      box-shadow: none;
    }

    .empty-stack {
      color: #9a8ac7;
      font-size: 1.8rem;
      padding: 40px 20px;
      text-align: center;
      width: 100%;
      border: 2px dashed #8a76c9;
      border-radius: 60px;
    }

    /* control panel */
    .stack-controls {
      flex: 1;
      min-width: 280px;
      background: #2e2550b3;
      border-radius: 70px;
      padding: 30px 25px;
      border: 3px solid #b197fa;
    }

    .quantum-palette h3 {
      color: #e4d9ff;
      font-size: 2rem;
      margin-bottom: 25px;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .quanta-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 18px;
      justify-content: center;
      margin-bottom: 35px;
    }

    .quantum-chip {
      background: #554690;
      border-radius: 60px;
      padding: 18px 24px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      border: 3px solid #b7a1ff;
      box-shadow: 0 7px 0 #312959;
      cursor: pointer;
      transition: 0.07s;
      width: 130px;
    }

    .quantum-chip:active {
      transform: translateY(7px);
      box-shadow: 0 0px 0 #312959;
    }

    .chip-emoji {
      font-size: 3.2rem;
    }

    .chip-name {
      font-size: 1.3rem;
      color: #f3ebff;
      font-weight: 500;
    }

    .chip-stability {
      background: #221e3a;
      border-radius: 30px;
      padding: 4px 16px;
      color: #aad0ff;
    }

    /* merge zone */
    .merge-zone {
      background: #1f193b;
      border-radius: 60px;
      padding: 25px 20px;
      border: 2px dashed #b09df5;
    }

    .merge-zone h4 {
      color: #cfc1ff;
      font-size: 1.5rem;
      margin-bottom: 18px;
      text-align: center;
    }

    .merge-btn {
      background: #866fd1;
      border: none;
      color: #1e132b;
      font-size: 1.8rem;
      padding: 18px 30px;
      border-radius: 60px;
      width: 100%;
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
      cursor: pointer;
      box-shadow: 0 10px 0 #4c3982;
      transition: 0.07s;
      border: 2px solid #ddc9ff;
    }

    .merge-btn:active {
      transform: translateY(10px);
      box-shadow: 0 2px 0 #4c3982;
    }

    .merge-btn:disabled {
      opacity: 0.4;
      transform: none;
      box-shadow: 0 7px 0 #4c3982;
      cursor: not-allowed;
    }
  </style>
</head>
<body>
  <div class="quantum-lab">
    <div class="quantum-header">
      <div class="title-stack">
        <h1>‚öõÔ∏è QUANTUM STACK</h1>
      </div>
      <div class="stack-counter" id="stackCounter">0 layers</div>
    </div>

    <!-- main arena -->
    <div class="stack-arena">
      <!-- stack tower -->
      <div class="stack-tower">
        <div class="tower-label">
          <span>üß¨</span> thought stack
        </div>
        <div class="stack-container" id="stackContainer">
          <div class="empty-stack">‚ú® add quanta from palette</div>
        </div>
      </div>

      <!-- control panel with quanta -->
      <div class="stack-controls">
        <div class="quantum-palette">
          <h3><span>üåÄ</span> quantum palette</h3>
          <div class="quanta-grid" id="quantaGrid">
            <!-- filled by js -->
          </div>
        </div>

        <!-- merge section -->
        <div class="merge-zone">
          <h4>‚ö° merge adjacent</h4>
          <button class="merge-btn" id="mergeBtn">
            <span>üîÆ</span> collapse
          </button>
          <p style="color:#b6a5f0; margin-top:15px; text-align:center;">combine top 2 layers</p>
        </div>
      </div>
    </div>
  </div>

  <script>
    (function() {
      // ---- quantum types ----
      const quantaTypes = [
        { emoji: '‚ö°', name: 'spark', baseStability: 20 },
        { emoji: 'üåÄ', name: 'vortex', baseStability: 35 },
        { emoji: 'üí´', name: 'dream', baseStability: 25 },
        { emoji: 'üåä', name: 'wave', baseStability: 30 },
        { emoji: 'üî•', name: 'flux', baseStability: 15 },
        { emoji: '‚ùÑÔ∏è', name: 'crystal', baseStability: 45 }
      ];

      // stack layers: array of { emoji, name, stability, id }
      let stack = [];

      // DOM
      const stackContainer = document.getElementById('stackContainer');
      const quantaGrid = document.getElementById('quantaGrid');
      const mergeBtn = document.getElementById('mergeBtn');
      const stackCounter = document.getElementById('stackCounter');

      // render quanta palette
      function renderPalette() {
        let html = '';
        quantaTypes.forEach((q, idx) => {
          html += `
            <div class="quantum-chip" data-index="${idx}">
              <span class="chip-emoji">${q.emoji}</span>
              <span class="chip-name">${q.name}</span>
              <span class="chip-stability">‚ö°${q.baseStability}</span>
            </div>
          `;
        });
        quantaGrid.innerHTML = html;

        // add click listeners
        document.querySelectorAll('.quantum-chip').forEach(chip => {
          chip.addEventListener('click', () => {
            const idx = chip.dataset.index;
            const q = quantaTypes[idx];
            // add a new layer with some random stability variation
            const variation = Math.floor(Math.random() * 10) - 3;
            const stability = Math.max(5, q.baseStability + variation);
            stack.push({
              id: 'layer_' + Date.now() + '_' + Math.random().toString(36).substr(2, 6),
              emoji: q.emoji,
              name: q.name,
              stability: stability
            });
            renderStack();
          });
        });
      }

      // render stack (bottom = oldest, top = newest)
      function renderStack() {
        if (stack.length === 0) {
          stackContainer.innerHTML = '<div class="empty-stack">‚ú® add quanta from palette</div>';
          updateCounter();
          return;
        }

        let html = '';
        // we want to show from top (last element) to bottom
        for (let i = stack.length - 1; i >= 0; i--) {
          const layer = stack[i];
          html += `
            <div class="quantum-layer" data-id="${layer.id}">
              <div class="layer-left">
                <span class="layer-emoji">${layer.emoji}</span>
                <span class="layer-text">${layer.name}</span>
              </div>
              <div class="layer-stability">‚ö°${layer.stability}</div>
              <button class="remove-layer" data-id="${layer.id}">‚úï</button>
            </div>
          `;
        }
        stackContainer.innerHTML = html;

        // attach remove buttons
        document.querySelectorAll('.remove-layer').forEach(btn => {
          btn.addEventListener('click', (e) => {
            e.stopPropagation();
            const id = btn.dataset.id;
            stack = stack.filter(l => l.id !== id);
            renderStack();
          });
        });

        updateCounter();
      }

      // merge top two layers (last two in stack)
      function mergeTop() {
        if (stack.length < 2) {
          alert('need at least 2 layers to merge');
          return;
        }

        const top = stack[stack.length - 1];
        const second = stack[stack.length - 2];

        // calculate new stability (quantum collapse)
        const newStability = Math.floor((top.stability + second.stability) / 2) + 5;
        // new name/emoji (combination)
        const newName = top.name.slice(0,3) + '+' + second.name.slice(0,3);
        const newEmoji = 'üîÆ'; // merged quantum

        // remove top two
        stack.pop();
        stack.pop();

        // push merged layer
        stack.push({
          id: 'merged_' + Date.now() + '_' + Math.random().toString(36).substr(2, 6),
          emoji: newEmoji,
          name: newName,
          stability: Math.min(99, newStability)
        });

        renderStack();
      }

      mergeBtn.addEventListener('click', mergeTop);

      function updateCounter() {
        stackCounter.innerText = stack.length + ' layer' + (stack.length !== 1 ? 's' : '');
      }

      // initialize palette
      renderPalette();

      // add some demo layers for engagement
      function initDemo() {
        stack.push({ id: 'demo1', emoji: '‚ö°', name: 'spark', stability: 22 });
        stack.push({ id: 'demo2', emoji: 'üåÄ', name: 'vortex', stability: 37 });
        stack.push({ id: 'demo3', emoji: 'üí´', name: 'dream', stability: 28 });
        renderStack();
      }
      initDemo();
    })();
  </script>
</body>
</html>