<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üåÄ STORY SPINNER ¬∑ brainstorm storytelling</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: linear-gradient(145deg, #1f2b3a, #0f1a24);
      font-family: 'Inter', 'Segoe UI', system-ui, sans-serif;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .story-wheel {
      max-width: 1300px;
      width: 100%;
      background: rgba(25, 35, 50, 0.8);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border-radius: 80px 80px 60px 60px;
      padding: 30px 30px 40px;
      border: 2px solid #b5a56b;
      box-shadow: 0 30px 40px -15px #010914, inset 0 0 30px #5b7a9b;
    }

    /* header with spinner */
    .spinner-header {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      background: #1e3140cc;
      border-radius: 100px;
      padding: 10px 20px 10px 35px;
      margin-bottom: 35px;
      border: 1px solid #e4c97c;
    }

    .title-spinner {
      display: flex;
      align-items: center;
      gap: 18px;
    }

    .title-spinner h1 {
      font-size: 2.8rem;
      font-weight: 500;
      background: linear-gradient(145deg, #ffefc0, #bdaf7a);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      letter-spacing: 2px;
    }

    .spin-button {
      background: #cd9f4b;
      border: none;
      color: #241f10;
      font-size: 2rem;
      width: 80px;
      height: 80px;
      border-radius: 80px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 0 10px 0 #614e2c, 0 12px 18px black;
      transition: 0.07s;
      border: 2px solid #ffeeb0;
    }

    .spin-button:active {
      transform: translateY(10px);
      box-shadow: 0 2px 0 #614e2c, 0 8px 12px black;
    }

    .story-count {
      background: #293f50;
      border-radius: 60px;
      padding: 10px 32px;
      color: #fbf3cf;
      font-size: 1.4rem;
      font-weight: 600;
      border: 1px solid #eacd87;
    }

    /* main display: current story */
    .story-stage {
      background: #1b2938f2;
      border-radius: 70px;
      padding: 45px 40px;
      border: 3px solid #cdb071;
      margin-bottom: 30px;
      box-shadow: inset 0 0 40px #141e28, 0 18px 25px -5px black;
      transition: background 0.3s;
    }

    .current-story {
      background: #fff9e6;
      border-radius: 50px;
      padding: 50px 50px;
      box-shadow: 15px 15px 0 #776b43, 0 0 0 5px #fee0a0 inset;
      transform: rotate(-0.2deg);
    }

    .story-text {
      font-size: 2.5rem;
      line-height: 1.4;
      font-weight: 500;
      color: #1d2b2b;
      text-align: center;
      word-break: break-word;
      font-family: 'Georgia', serif;
      text-shadow: 2px 2px 0 #ffffff70;
      margin-bottom: 30px;
      min-height: 180px;
    }

    .story-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-top: 2px solid #b59b56;
      padding-top: 25px;
    }

    .story-tags {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
    }

    .tag {
      background: #574c30;
      color: #ffe6a6;
      border-radius: 50px;
      padding: 10px 25px;
      font-size: 1.2rem;
      border: 1px solid #e3bc74;
    }

    .story-actions {
      display: flex;
      gap: 15px;
    }

    .story-btn {
      background: #3f5572;
      border: none;
      color: #ffefc0;
      font-size: 1.4rem;
      padding: 14px 32px;
      border-radius: 60px;
      display: flex;
      align-items: center;
      gap: 10px;
      cursor: pointer;
      transition: 0.1s;
      border: 1px solid #dbb161;
      box-shadow: 0 6px 0 #1d2b38;
    }

    .story-btn:active {
      transform: translateY(6px);
      box-shadow: 0 1px 0 #1d2b38;
    }

    .story-btn.save {
      background: #527a5f;
    }

    /* history of spun stories */
    .history-rail {
      background: #192c38b8;
      border-radius: 70px;
      padding: 25px 25px;
      border: 1px solid #b5975b;
    }

    .rail-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 18px;
      color: #f5e1b9;
      font-size: 1.5rem;
      padding-left: 18px;
    }

    .story-chips {
      display: flex;
      flex-wrap: wrap;
      gap: 18px;
      align-items: center;
      min-height: 90px;
    }

    .story-chip {
      background: #2d4352;
      border-radius: 50px;
      padding: 12px 28px;
      display: flex;
      align-items: center;
      gap: 16px;
      border: 2px solid #d9b56c;
      box-shadow: 0 6px 0 #11212b;
      transition: 0.1s;
      max-width: 280px;
    }

    .chip-icon {
      font-size: 2rem;
    }

    .chip-text {
      font-size: 1.2rem;
      color: #fdf0cf;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 150px;
    }

    .chip-restore {
      background: none;
      border: none;
      color: #ffdb9f;
      font-size: 1.5rem;
      cursor: pointer;
      padding: 0 6px;
    }

    .empty-history {
      color: #98abbe;
      font-size: 1.4rem;
      font-style: italic;
      padding: 25px 20px;
      border: 2px dashed #8f874b;
      border-radius: 60px;
      width: 100%;
      text-align: center;
    }

    /* footer */
    .foot-note {
      margin-top: 20px;
      text-align: right;
      color: #b5a776;
      padding: 0 15px;
    }
  </style>
</head>
<body>
  <div class="story-wheel">
    <!-- header with spin control -->
    <div class="spinner-header">
      <div class="title-spinner">
        <h1>üìñ STORY SPINNER</h1>
        <button class="spin-button" id="spinBtn">üé≤</button>
      </div>
      <div class="story-count" id="storyCounter">0 stories</div>
    </div>

    <!-- current story card -->
    <div class="story-stage">
      <div class="current-story" id="currentStoryCard">
        <div class="story-text" id="storyTextDisplay">
          Click spin to generate a story idea
        </div>
        <div class="story-meta">
          <div class="story-tags" id="storyTags">
            <span class="tag">‚ú® fresh</span>
          </div>
          <div class="story-actions">
            <button class="story-btn" id="saveStoryBtn">üíæ save</button>
            <button class="story-btn" id="regenerateBtn">üîÑ regen</button>
          </div>
        </div>
      </div>
    </div>

    <!-- saved / history rail -->
    <div class="history-rail">
      <div class="rail-header">
        <span>üìö</span> <span>previously spun</span>
      </div>
      <div class="story-chips" id="historyContainer">
        <div class="empty-history">‚ú® spin and save your first story</div>
      </div>
    </div>
    <div class="foot-note">
      ‚ö° each spin combines random ingredients ‚Üí unique tale
    </div>
  </div>

  <script>
    (function() {
      // ----- story generator data -----
      const protagonists = [
        'a lost astronaut', 'a curious cat', 'an old librarian', 'a time-traveling chef',
        'a robot gardener', 'a pirate queen', 'a shy wizard', 'a detective duck',
        'a ghost in the attic', 'a runaway train', 'a singing statue', 'a cloud sculptor'
      ];

      const actions = [
        'discovers', 'steals', 'paints', 'sings to', 'destroys', 'builds',
        'escapes from', 'dances with', 'unlocks', 'plants', 'whispers to', 'fights'
      ];

      const objects = [
        'a magic key', 'the last star', 'a forgotten song', 'a purple onion',
        'a talking stone', 'the moon', 'a secret map', 'a tin whistle',
        'a glowing seed', 'a cursed selfie', 'an infinite sandwich', 'a broken compass'
      ];

      const settings = [
        'on Mars', 'in a silent library', 'under the ocean', 'at midnight',
        'inside a dream', 'during a storm', 'in a haunted mall', 'on a flying island',
        'in the year 3099', 'behind the waterfall', 'in a coffee shop', 'among the clouds'
      ];

      // story database: all generated stories (history)
      let savedStories = []; // each { id, text, protagonist, action, object, setting, timestamp }

      // current story object
      let currentStory = {
        id: 'init_' + Date.now(),
        text: 'Click spin to generate a story idea',
        protagonist: '‚ú®',
        action: '',
        object: '',
        setting: '',
        timestamp: Date.now()
      };

      // DOM elements
      const storyTextDisplay = document.getElementById('storyTextDisplay');
      const storyTags = document.getElementById('storyTags');
      const spinBtn = document.getElementById('spinBtn');
      const saveStoryBtn = document.getElementById('saveStoryBtn');
      const regenerateBtn = document.getElementById('regenerateBtn');
      const historyContainer = document.getElementById('historyContainer');
      const storyCounter = document.getElementById('storyCounter');

      // helper: generate a random story object
      function generateRandomStory() {
        const protagonist = protagonists[Math.floor(Math.random() * protagonists.length)];
        const action = actions[Math.floor(Math.random() * actions.length)];
        const object = objects[Math.floor(Math.random * objects.length)]; // FIX: was incorrectly using length
        const objectFixed = objects[Math.floor(Math.random() * objects.length)];
        const setting = settings[Math.floor(Math.random() * settings.length)];
        // build text
        const text = `${protagonist} ${action} ${objectFixed} ${setting}.`;
        return {
          id: 'story_' + Date.now() + '_' + Math.random().toString(36).substr(2, 6),
          protagonist,
          action,
          object: objectFixed,
          setting,
          text,
          timestamp: Date.now()
        };
      }

      // render current story to UI
      function renderCurrentStory() {
        storyTextDisplay.innerText = currentStory.text;
        // create tag html
        let tagsHtml = '';
        if (currentStory.protagonist) {
          tagsHtml += `<span class="tag">üßô ${currentStory.protagonist.substring(0, 18)}</span>`;
        }
        if (currentStory.setting) {
          tagsHtml += `<span class="tag">üåç ${currentStory.setting.substring(0, 18)}</span>`;
        }
        if (currentStory.object) {
          tagsHtml += `<span class="tag">üîÆ ${currentStory.object.substring(0, 18)}</span>`;
        }
        storyTags.innerHTML = tagsHtml || '<span class="tag">‚ú® new</span>';
      }

      // render history chips
      function renderHistory() {
        if (savedStories.length === 0) {
          historyContainer.innerHTML = '<div class="empty-history">‚ú® spin and save your first story</div>';
          return;
        }

        let chipsHtml = '';
        // show last 8, newest first
        const recent = [...savedStories].reverse().slice(0, 8);
        recent.forEach(story => {
          const shortText = story.text.length > 35 ? story.text.slice(0, 32) + '‚Ä¶' : story.text;
          chipsHtml += `
            <div class="story-chip" data-id="${story.id}">
              <span class="chip-icon">üìñ</span>
              <span class="chip-text">${shortText}</span>
              <button class="chip-restore" data-id="${story.id}" title="load this story">‚Ü©</button>
            </div>
          `;
        });
        historyContainer.innerHTML = chipsHtml;

        // attach restore listeners
        document.querySelectorAll('.chip-restore').forEach(btn => {
          btn.addEventListener('click', (e) => {
            e.stopPropagation();
            const id = btn.dataset.id;
            const story = savedStories.find(s => s.id === id);
            if (story) {
              currentStory = { ...story }; // copy
              renderCurrentStory();
            }
          });
        });
      }

      // update story counter
      function updateCounter() {
        storyCounter.innerText = savedStories.length + ' story' + (savedStories.length !== 1 ? 's' : '');
      }

      // spin new story (and set as current)
      function spinNewStory() {
        currentStory = generateRandomStory();
        renderCurrentStory();
      }

      // save current story to history
      function saveCurrentStory() {
        // avoid duplicate identical? we can allow duplicates, but check if it's exactly same text?
        // but it's fun to have duplicates, we keep.
        const storyCopy = { ...currentStory, id: 'saved_' + Date.now() + '_' + Math.random().toString(36).substr(2, 4) };
        savedStories.push(storyCopy);
        renderHistory();
        updateCounter();
      }

      // event listeners
      spinBtn.addEventListener('click', () => {
        spinNewStory();
      });

      regenerateBtn.addEventListener('click', () => {
        spinNewStory();
      });

      saveStoryBtn.addEventListener('click', () => {
        // only save if story is not the placeholder?
        if (currentStory.text && currentStory.text !== 'Click spin to generate a story idea') {
          saveCurrentStory();
        } else {
          alert('spin a story first!');
        }
      });

      // initialize with one random story for engagement
      function initDemo() {
        currentStory = generateRandomStory();
        renderCurrentStory();
        // add a couple of saved examples
        const demo1 = generateRandomStory();
        const demo2 = generateRandomStory();
        savedStories.push(demo1, demo2);
        renderHistory();
        updateCounter();
      }

      initDemo();

      // extra: double-click on stage to spin
      document.querySelector('.story-stage').addEventListener('dblclick', () => {
        spinNewStory();
      });
    })();
  </script>
</body>
</html>